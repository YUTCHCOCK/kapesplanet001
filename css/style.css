// 반응형 최적화 JavaScript
console.log('반응형 최적화 스크립트 로드됨');

// 디바이스 감지 및 성능 최적화
const isMobile = window.innerWidth <= 768;
const isTablet = window.innerWidth > 768 && window.innerWidth <= 1024;
const isDesktop = window.innerWidth > 1024;

// 디바운스 함수 (성능 최적화)
function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
}

// 쓰로틀 함수 (스크롤 성능 최적화)
function throttle(func, limit) {
    let inThrottle;
    return function() {
        const args = arguments;
        const context = this;
        if (!inThrottle) {
            func.apply(context, args);
            inThrottle = true;
            setTimeout(() => inThrottle = false, limit);
        }
    }
}

document.addEventListener('DOMContentLoaded', function() {
    console.log('DOM 로드 완료 - 반응형 초기화');
    initResponsiveFeatures();
    setupNavigation();
    setupMobileMenu();
    setupHeaderEffects();
    setupPortfolioFilter();
    setupVideoModal();
    renderBoard();
    setupResizeHandlers();
    console.log('반응형 설정 완료');
});

// 반응형 기능 초기화
function initResponsiveFeatures() {
    // 뷰포트 메타태그 동적 설정
    const viewport = document.querySelector('meta[name="viewport"]');
    if (viewport) {
        viewport.setAttribute('content', 'width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes');
    }
    
    // 디바이스별 클래스 추가
    document.body.classList.add(
        isMobile ? 'mobile' : 
        isTablet ? 'tablet' : 'desktop'
    );
    
    // 터치 디바이스 감지
    if ('ontouchstart' in window) {
        document.body.classList.add('touch-device');
    }
}

// 리사이즈 핸들러 설정
function setupResizeHandlers() {
    const handleResize = debounce(() => {
        const currentWidth = window.innerWidth;
        
        // 디바이스 타입 업데이트
        document.body.classList.remove('mobile', 'tablet', 'desktop');
        if (currentWidth <= 768) {
            document.body.classList.add('mobile');
            handleMobileResize();
        } else if (currentWidth <= 1024) {
            document.body.classList.add('tablet');
            handleTabletResize();
        } else {
            document.body.classList.add('desktop');
            handleDesktopResize();
        }
        
        // 히어로 섹션 높이 조정
        adjustHeroHeight();
        
        // 워터마크 크기 조정
        adjustWatermarkSize();
        
    }, 250);
    
    window.addEventListener('resize', handleResize);
    window.addEventListener('orientationchange', debounce(handleResize, 500));
}

// 모바일 리사이즈 처리
function handleMobileResize() {
    // 모바일 메뉴 상태 확인
    const nav = document.querySelector('header nav');
    if (nav && nav.classList.contains('active')) {
        // 화면 회전시 메뉴 닫기
        nav.classList.remove('active');
    }
    
    // 모바일 비디오 모달 크기 조정
    adjustMobileVideoModal();
}

// 태블릿 리사이즈 처리
function handleTabletResize() {
    // 태블릿 특화 처리
    const nav = document.querySelector('header nav');
    if (nav) {
        nav.classList.remove('active');
    }
}

// 데스크톱 리사이즈 처리
function handleDesktopResize() {
    // 데스크톱 특화 처리
    const nav = document.querySelector('header nav');
    if (nav) {
        nav.classList.remove('active');
    }
}

// 히어로 섹션 높이 동적 조정
function adjustHeroHeight() {
    const hero = document.querySelector('.hero');
    if (!hero) return;
    
    const viewportHeight = window.innerHeight;
    const viewportWidth = window.innerWidth;
    
    if (viewportWidth <= 768) {
        // 모바일: 전체 화면 높이
        hero.style.height = `${viewportHeight}px`;
    } else if (viewportWidth <= 1024) {
        // 태블릿: 80vh
        hero.style.height = '80vh';
    } else {
        // 데스크톱: 원래 설정 유지
        hero.style.height = '';
    }
}

// 워터마크 크기 동적 조정
function adjustWatermarkSize() {
    const watermarks = document.querySelectorAll('.monkey-watermark');
    const viewportWidth = window.innerWidth;
    
    watermarks.forEach(watermark => {
        if (viewportWidth <= 480) {
            watermark.style.width = '60px';
        } else if (viewportWidth <= 768) {
            watermark.style.width = '80px';
        } else if (viewportWidth <= 1024) {
            watermark.style.width = '120px';
        } else {
            watermark.style.width = '220px';
        }
    });
}

// 모바일 비디오 모달 조정
function adjustMobileVideoModal() {
    const modal = document.querySelector('.video-modal iframe');
    if (!modal) return;
    
    const viewportWidth = window.innerWidth;
    const viewportHeight = window.innerHeight;
    
    if (viewportWidth <= 768) {
        modal.style.width = '95vw';
        modal.style.height = '53vw'; // 16:9 비율 유지
        modal.style.max
